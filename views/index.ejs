<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QR Generator Pro</title>
<link rel="stylesheet" href="/style.css">
</head>
<body class="<%= darkMode ? 'dark-mode' : '' %>">

<header>
  <h1>üì± Generador de C√≥digos QR Profesional</h1>
  <form action="/toggle-dark" method="post" style="display:inline">
    <button type="submit">Toggle Dark Mode</button>
  </form>
  <form action="/logout" method="post" style="display:inline">
    <button type="submit">Cerrar sesi√≥n</button>
  </form>
  <a href="/change-password">Cambiar contrase√±a</a>
</header>

<main>
  <form action="/generate" method="POST">
    <input type="url" name="url" placeholder="Introduce la URL" required>
    <button type="submit">Generar QR</button>
  </form>

  <div class="qr-grid">
    <% if (qrList.length === 0) { %>
      <p class="empty-state">A√∫n no has generado ning√∫n QR.</p>
    <% } %>

    <% qrList.forEach(qr => { %>
      <div class="qr-card">
        <div class="qr-preview"><img src="<%= qr.qrDataUrl %>" alt="QR"></div>
        <div class="qr-details">
          <p><strong>Original:</strong> <a href="<%= qr.originalUrl %>" target="_blank"><%= qr.originalUrl %></a></p>
          <p><strong>QR corto:</strong> <a href="<%= qr.shortInternalUrl %>" target="_blank"><%= qr.shortInternalUrl %></a></p>
          <p><strong>Escaneos:</strong> <%= qr.scans %></p>
          <p><strong>√öltimo escaneo:</strong> <%= qr.lastScan || "Nunca" %></p>

          <form action="/update/<%= qr.id %>" method="POST" class="update-form">
            <input type="url" name="newUrl" placeholder="Nueva URL" required>
            <button type="submit" class="btn-update">Actualizar</button>
          </form>

          <form action="/delete/<%= qr.id %>" method="POST" class="delete-form">
            <button type="submit" class="btn-delete">Eliminar</button>
          </form>
        </div>
      </div>
    <% }) %>
  </div>
</main>

</body>
</html>
